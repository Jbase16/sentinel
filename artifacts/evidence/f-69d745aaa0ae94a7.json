{
  "version": "1.0",
  "finding_id": {
    "value": "f-69d745aaa0ae94a7"
  },
  "mission_id": {
    "value": "m-idor-test"
  },
  "scan_id": {
    "value": "s-idor-test"
  },
  "session_id": {
    "value": "ss-idor-test"
  },
  "vuln_class": "idor",
  "title": "Insecure Direct Object Reference (IDOR)",
  "summary": "Cross-principal authorization bypass detected. Principal B successfully accessed Principal A's baseline resource with structurally identical response.",
  "principal_id": {
    "value": "p-owner123"
  },
  "affected_principals": [
    {
      "value": "p-owner123"
    },
    {
      "value": "p-attk123"
    }
  ],
  "principal_states": [
    {
      "principal_id": {
        "value": "p-owner123"
      },
      "cookies": {
        "session_id": "sess_owner",
        "csrf_token": "csrf_owner"
      },
      "user_agent": ""
    },
    {
      "principal_id": {
        "value": "p-attk123"
      },
      "cookies": {
        "session_id": "sess_attacker",
        "csrf_token": "csrf_attacker"
      },
      "user_agent": ""
    }
  ],
  "request_sequence": [
    {
      "request_id": {
        "value": "req-00000002"
      },
      "url": "http://localhost:8081/search?q=test",
      "method": "GET",
      "request_headers": {},
      "request_body_b64": null,
      "response_status": 200,
      "response_headers": {
        "server": "BaseHTTP/0.6 Python/3.14.2",
        "date": "Wed, 25 Feb 2026 07:02:56 GMT",
        "content-type": "text/html"
      },
      "response_body_b64": "PGh0bWw+PGJvZHk+U2VhcmNoIHJlc3VsdHM8L2JvZHk+PC9odG1sPg==",
      "captured_at": "2026-02-25T07:02:56.547685"
    },
    {
      "request_id": {
        "value": "req-00000002"
      },
      "url": "http://localhost:8081/search?q=test",
      "method": "GET",
      "request_headers": {},
      "request_body_b64": null,
      "response_status": 200,
      "response_headers": {
        "server": "BaseHTTP/0.6 Python/3.14.2",
        "date": "Wed, 25 Feb 2026 07:02:56 GMT",
        "content-type": "text/html"
      },
      "response_body_b64": "PGh0bWw+PGJvZHk+U2VhcmNoIHJlc3VsdHM8L2JvZHk+PC9odG1sPg==",
      "captured_at": "2026-02-25T07:02:56.554562"
    }
  ],
  "baseline": {
    "status_code": 200,
    "body_hash": "c09b806edf7eea1e54b1f518bdf3d4ceb52426483c45411396a155d72cd9cdc8",
    "normalized_hash": "c09b806edf7eea1e54b1f518bdf3d4ceb52426483c45411396a155d72cd9cdc8",
    "dom_hash": null,
    "json_shape_hash": null,
    "ttfb_ms": 0,
    "total_ms": 1
  },
  "delta": {
    "status_delta": null,
    "body_length_delta": null,
    "structural_delta": 0.0,
    "timing_delta_ms": -1,
    "severity": "high",
    "notes": [
      "Cross-principal identical response detected."
    ]
  },
  "vulnerable_param": null,
  "artifacts": [
    {
      "artifact_id": {
        "value": "art-f-69d745aaa0ae94a7-replay"
      },
      "kind": "replay_script",
      "path": "artifacts/replays/f-69d745aaa0ae94a7.py",
      "sha256": "4c9413331122e284841058fd28f52ccb67ea22740a03a1986643a92911b96c43"
    }
  ],
  "replay_script_path": "artifacts/replays/f-69d745aaa0ae94a7.py",
  "artifact_hash": "073a1d61075fb4985d788efd3a373cff11dd462674cf3acbe0378e2eafc0c85e",
  "created_at": "2026-02-25T07:02:56.560254"
}